[2022-12-27 15:50:01,981] {processor.py:163} INFO - Started process (PID=169) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:01,984] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:50:01,985] {logging_mixin.py:109} INFO - [2022-12-27 15:50:01,985] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:02,901] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:50:12,978] {logging_mixin.py:109} INFO - [2022-12-27 15:50:12,910] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "marvel" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 204, in run_etl
    conn = connect_db()
  File "/opt/airflow/dags/etl.py", line 198, in connect_db
    conn.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2263, in connect
    return self._connection_cls(self, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 104, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2370, in raw_connection
    self.pool.unique_connection, _connection
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "marvel" to address: Temporary failure in name resolution

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-12-27 15:50:13,015] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:13,045] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 11.070 seconds
[2022-12-27 15:50:43,180] {processor.py:163} INFO - Started process (PID=206) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:43,184] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:50:43,185] {logging_mixin.py:109} INFO - [2022-12-27 15:50:43,185] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:43,988] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:50:54,000] {logging_mixin.py:109} INFO - [2022-12-27 15:50:53,995] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "marvel" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 204, in run_etl
    conn = connect_db()
  File "/opt/airflow/dags/etl.py", line 198, in connect_db
    conn.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2263, in connect
    return self._connection_cls(self, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 104, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2370, in raw_connection
    self.pool.unique_connection, _connection
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "marvel" to address: Temporary failure in name resolution

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-12-27 15:50:54,018] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:50:54,028] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 10.853 seconds
[2022-12-27 15:51:24,120] {processor.py:163} INFO - Started process (PID=242) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:51:24,122] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:51:24,123] {logging_mixin.py:109} INFO - [2022-12-27 15:51:24,123] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:51:24,633] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:51:34,644] {logging_mixin.py:109} INFO - [2022-12-27 15:51:34,641] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "marvel" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 204, in run_etl
    conn = connect_db()
  File "/opt/airflow/dags/etl.py", line 198, in connect_db
    conn.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2263, in connect
    return self._connection_cls(self, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 104, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2370, in raw_connection
    self.pool.unique_connection, _connection
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2340, in _wrap_pool_connect
    e, dialect, self
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1584, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2336, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 304, in unique_connection
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 778, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 495, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 140, in _do_get
    self._dec_overflow()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/impl.py", line 137, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 309, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 440, in __init__
    self.__connect(first_connect_check=True)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 661, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    with_traceback=exc_tb,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/pool/base.py", line 656, in __connect
    connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 508, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "marvel" to address: Temporary failure in name resolution

(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-12-27 15:51:34,692] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:51:34,705] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 10.588 seconds
[2022-12-27 15:52:04,788] {processor.py:163} INFO - Started process (PID=280) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:52:04,798] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:52:04,799] {logging_mixin.py:109} INFO - [2022-12-27 15:52:04,799] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:52:05,298] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:52:09,323] {logging_mixin.py:109} INFO - [2022-12-27 15:52:09,306] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 288, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 756, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/retry.py", line 532, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/packages/six.py", line 769, in reraise
    raise value.with_traceback(tb)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 288, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 206, in run_etl
    get_character().to_sql(name='characters', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 136, in get_character
    r = rq.get(f'{baseurl}{endpoint}/{a}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 498, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
[2022-12-27 15:52:09,337] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:52:09,347] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 4.564 seconds
[2022-12-27 15:52:39,428] {processor.py:163} INFO - Started process (PID=318) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:52:39,430] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:52:39,433] {logging_mixin.py:109} INFO - [2022-12-27 15:52:39,432] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:52:40,097] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:53:09,435] {logging_mixin.py:109} INFO - [2022-12-27 15:53:09,435] {timeout.py:36} ERROR - Process timed out, PID: 318
[2022-12-27 15:53:09,443] {logging_mixin.py:109} INFO - [2022-12-27 15:53:09,436] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 318
[2022-12-27 15:53:09,475] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:53:09,494] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.069 seconds
[2022-12-27 15:53:39,613] {processor.py:163} INFO - Started process (PID=364) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:53:39,619] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:53:39,620] {logging_mixin.py:109} INFO - [2022-12-27 15:53:39,620] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:53:40,233] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:54:09,636] {logging_mixin.py:109} INFO - [2022-12-27 15:54:09,636] {timeout.py:36} ERROR - Process timed out, PID: 364
[2022-12-27 15:54:09,640] {logging_mixin.py:109} INFO - [2022-12-27 15:54:09,637] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 364
[2022-12-27 15:54:09,655] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:54:09,665] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.056 seconds
[2022-12-27 15:54:39,782] {processor.py:163} INFO - Started process (PID=421) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:54:39,784] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:54:39,786] {logging_mixin.py:109} INFO - [2022-12-27 15:54:39,785] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:54:40,768] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:55:09,787] {logging_mixin.py:109} INFO - [2022-12-27 15:55:09,786] {timeout.py:36} ERROR - Process timed out, PID: 421
[2022-12-27 15:55:09,794] {logging_mixin.py:109} INFO - [2022-12-27 15:55:09,788] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 421
[2022-12-27 15:55:09,816] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:55:09,829] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.061 seconds
[2022-12-27 15:55:39,934] {processor.py:163} INFO - Started process (PID=475) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:55:39,939] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:55:39,940] {logging_mixin.py:109} INFO - [2022-12-27 15:55:39,940] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:55:40,587] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:56:09,942] {logging_mixin.py:109} INFO - [2022-12-27 15:56:09,941] {timeout.py:36} ERROR - Process timed out, PID: 475
[2022-12-27 15:56:09,947] {logging_mixin.py:109} INFO - [2022-12-27 15:56:09,942] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 475
[2022-12-27 15:56:09,970] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:56:09,986] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.057 seconds
[2022-12-27 15:56:40,114] {processor.py:163} INFO - Started process (PID=522) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:56:40,116] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:56:40,117] {logging_mixin.py:109} INFO - [2022-12-27 15:56:40,117] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:56:40,820] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:57:10,118] {logging_mixin.py:109} INFO - [2022-12-27 15:57:10,118] {timeout.py:36} ERROR - Process timed out, PID: 522
[2022-12-27 15:57:10,124] {logging_mixin.py:109} INFO - [2022-12-27 15:57:10,119] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 522
[2022-12-27 15:57:10,163] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:57:10,194] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.085 seconds
[2022-12-27 15:57:40,368] {processor.py:163} INFO - Started process (PID=578) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:57:40,369] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:57:40,370] {logging_mixin.py:109} INFO - [2022-12-27 15:57:40,370] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:57:42,126] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:58:10,385] {logging_mixin.py:109} INFO - [2022-12-27 15:58:10,384] {timeout.py:36} ERROR - Process timed out, PID: 578
[2022-12-27 15:58:10,404] {logging_mixin.py:109} INFO - [2022-12-27 15:58:10,388] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 578
[2022-12-27 15:58:10,442] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:58:10,556] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.212 seconds
[2022-12-27 15:58:40,637] {processor.py:163} INFO - Started process (PID=632) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:58:40,638] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:58:40,639] {logging_mixin.py:109} INFO - [2022-12-27 15:58:40,639] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:58:41,562] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 15:59:10,640] {logging_mixin.py:109} INFO - [2022-12-27 15:59:10,640] {timeout.py:36} ERROR - Process timed out, PID: 632
[2022-12-27 15:59:10,644] {logging_mixin.py:109} INFO - [2022-12-27 15:59:10,641] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 632
[2022-12-27 15:59:10,664] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:59:10,675] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.042 seconds
[2022-12-27 15:59:40,773] {processor.py:163} INFO - Started process (PID=677) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 15:59:40,774] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 15:59:40,774] {logging_mixin.py:109} INFO - [2022-12-27 15:59:40,774] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 15:59:41,294] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:00:10,775] {logging_mixin.py:109} INFO - [2022-12-27 16:00:10,775] {timeout.py:36} ERROR - Process timed out, PID: 677
[2022-12-27 16:00:10,778] {logging_mixin.py:109} INFO - [2022-12-27 16:00:10,776] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 677
[2022-12-27 16:00:10,794] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:00:10,806] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.036 seconds
[2022-12-27 16:00:40,900] {processor.py:163} INFO - Started process (PID=731) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:00:40,901] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:00:40,902] {logging_mixin.py:109} INFO - [2022-12-27 16:00:40,901] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:00:41,405] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:01:10,903] {logging_mixin.py:109} INFO - [2022-12-27 16:01:10,902] {timeout.py:36} ERROR - Process timed out, PID: 731
[2022-12-27 16:01:10,908] {logging_mixin.py:109} INFO - [2022-12-27 16:01:10,905] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 731
[2022-12-27 16:01:10,929] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:01:10,942] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.045 seconds
[2022-12-27 16:01:13,978] {processor.py:163} INFO - Started process (PID=767) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:01:13,980] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:01:13,981] {logging_mixin.py:109} INFO - [2022-12-27 16:01:13,981] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:01:14,430] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:01:43,982] {logging_mixin.py:109} INFO - [2022-12-27 16:01:43,982] {timeout.py:36} ERROR - Process timed out, PID: 767
[2022-12-27 16:01:43,985] {logging_mixin.py:109} INFO - [2022-12-27 16:01:43,983] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 767
[2022-12-27 16:01:44,000] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:01:44,013] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.039 seconds
[2022-12-27 16:02:14,105] {processor.py:163} INFO - Started process (PID=819) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:02:14,108] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:02:14,109] {logging_mixin.py:109} INFO - [2022-12-27 16:02:14,109] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:02:14,642] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:02:42,962] {logging_mixin.py:109} INFO - [2022-12-27 16:02:42,946] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1277, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 608, in do_execute
    cursor.execute(statement, parameters)
psycopg2.OperationalError: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 856, in create
    if self.exists():
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 840, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1787, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2212, in run_callable
    return conn.run_callable(callable_, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1653, in run_callable
    return callable_(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/base.py", line 2805, in has_table
    type_=sqltypes.Unicode,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1317, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1277, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 608, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[SQL: select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s]
[parameters: {'name': 'comics'}]
(Background on this error at: http://sqlalche.me/e/13/e3q8)
[2022-12-27 16:02:42,974] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:02:42,984] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 28.886 seconds
[2022-12-27 16:05:17,154] {processor.py:163} INFO - Started process (PID=171) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:05:17,156] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:05:17,157] {logging_mixin.py:109} INFO - [2022-12-27 16:05:17,157] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:05:19,569] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:05:47,155] {logging_mixin.py:109} INFO - [2022-12-27 16:05:47,155] {timeout.py:36} ERROR - Process timed out, PID: 171
[2022-12-27 16:05:47,159] {logging_mixin.py:109} INFO - [2022-12-27 16:05:47,156] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 171
[2022-12-27 16:05:47,178] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:05:47,190] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.044 seconds
[2022-12-27 16:06:17,285] {processor.py:163} INFO - Started process (PID=216) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:06:17,290] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:06:17,290] {logging_mixin.py:109} INFO - [2022-12-27 16:06:17,290] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:06:17,885] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:06:47,290] {logging_mixin.py:109} INFO - [2022-12-27 16:06:47,289] {timeout.py:36} ERROR - Process timed out, PID: 216
[2022-12-27 16:06:47,304] {logging_mixin.py:109} INFO - [2022-12-27 16:06:47,291] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 216
[2022-12-27 16:06:47,365] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:06:47,402] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.123 seconds
[2022-12-27 16:07:17,587] {processor.py:163} INFO - Started process (PID=271) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:07:17,592] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:07:17,593] {logging_mixin.py:109} INFO - [2022-12-27 16:07:17,593] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:07:18,021] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:07:47,594] {logging_mixin.py:109} INFO - [2022-12-27 16:07:47,593] {timeout.py:36} ERROR - Process timed out, PID: 271
[2022-12-27 16:07:47,598] {logging_mixin.py:109} INFO - [2022-12-27 16:07:47,595] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 271
[2022-12-27 16:07:47,613] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:07:47,625] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.041 seconds
[2022-12-27 16:08:17,696] {processor.py:163} INFO - Started process (PID=316) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:08:17,698] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:08:17,698] {logging_mixin.py:109} INFO - [2022-12-27 16:08:17,698] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:08:19,121] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:08:47,702] {logging_mixin.py:109} INFO - [2022-12-27 16:08:47,702] {timeout.py:36} ERROR - Process timed out, PID: 316
[2022-12-27 16:08:47,704] {logging_mixin.py:109} INFO - [2022-12-27 16:08:47,703] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 316
[2022-12-27 16:08:47,720] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:08:47,733] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.038 seconds
[2022-12-27 16:09:17,881] {processor.py:163} INFO - Started process (PID=373) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:09:17,884] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:09:17,885] {logging_mixin.py:109} INFO - [2022-12-27 16:09:17,885] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:09:18,490] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:09:47,886] {logging_mixin.py:109} INFO - [2022-12-27 16:09:47,886] {timeout.py:36} ERROR - Process timed out, PID: 373
[2022-12-27 16:09:47,890] {logging_mixin.py:109} INFO - [2022-12-27 16:09:47,887] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 373
[2022-12-27 16:09:47,906] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:09:47,919] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.041 seconds
[2022-12-27 16:10:18,057] {processor.py:163} INFO - Started process (PID=428) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:10:18,058] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:10:18,059] {logging_mixin.py:109} INFO - [2022-12-27 16:10:18,059] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:10:19,020] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:10:48,061] {logging_mixin.py:109} INFO - [2022-12-27 16:10:48,060] {timeout.py:36} ERROR - Process timed out, PID: 428
[2022-12-27 16:10:48,064] {logging_mixin.py:109} INFO - [2022-12-27 16:10:48,062] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 428
[2022-12-27 16:10:48,078] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:10:48,091] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.038 seconds
[2022-12-27 16:11:18,192] {processor.py:163} INFO - Started process (PID=475) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:11:18,194] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:11:18,195] {logging_mixin.py:109} INFO - [2022-12-27 16:11:18,195] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:11:18,929] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:11:48,196] {logging_mixin.py:109} INFO - [2022-12-27 16:11:48,196] {timeout.py:36} ERROR - Process timed out, PID: 475
[2022-12-27 16:11:48,200] {logging_mixin.py:109} INFO - [2022-12-27 16:11:48,197] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 475
[2022-12-27 16:11:48,216] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:11:48,229] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.041 seconds
[2022-12-27 16:12:18,326] {processor.py:163} INFO - Started process (PID=531) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:12:18,328] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:12:18,329] {logging_mixin.py:109} INFO - [2022-12-27 16:12:18,329] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:12:20,076] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:12:48,348] {logging_mixin.py:109} INFO - [2022-12-27 16:12:48,347] {timeout.py:36} ERROR - Process timed out, PID: 531
[2022-12-27 16:12:48,351] {logging_mixin.py:109} INFO - [2022-12-27 16:12:48,348] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 531
[2022-12-27 16:12:48,371] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:12:48,389] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.052 seconds
[2022-12-27 16:13:18,508] {processor.py:163} INFO - Started process (PID=578) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:13:18,515] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:13:18,516] {logging_mixin.py:109} INFO - [2022-12-27 16:13:18,516] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:13:19,217] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:13:48,519] {logging_mixin.py:109} INFO - [2022-12-27 16:13:48,519] {timeout.py:36} ERROR - Process timed out, PID: 578
[2022-12-27 16:13:48,524] {logging_mixin.py:109} INFO - [2022-12-27 16:13:48,520] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 578
[2022-12-27 16:13:48,551] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:13:48,585] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.082 seconds
[2022-12-27 16:14:18,703] {processor.py:163} INFO - Started process (PID=634) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:14:18,708] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:14:18,708] {logging_mixin.py:109} INFO - [2022-12-27 16:14:18,708] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:14:19,231] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:14:48,710] {logging_mixin.py:109} INFO - [2022-12-27 16:14:48,710] {timeout.py:36} ERROR - Process timed out, PID: 634
[2022-12-27 16:14:48,713] {logging_mixin.py:109} INFO - [2022-12-27 16:14:48,711] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 634
[2022-12-27 16:14:48,736] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:14:48,751] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.054 seconds
[2022-12-27 16:15:18,901] {processor.py:163} INFO - Started process (PID=688) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:15:18,904] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:15:18,905] {logging_mixin.py:109} INFO - [2022-12-27 16:15:18,905] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:15:19,452] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:15:48,906] {logging_mixin.py:109} INFO - [2022-12-27 16:15:48,906] {timeout.py:36} ERROR - Process timed out, PID: 688
[2022-12-27 16:15:48,912] {logging_mixin.py:109} INFO - [2022-12-27 16:15:48,907] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 688
[2022-12-27 16:15:48,932] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:15:48,946] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.049 seconds
[2022-12-27 16:16:19,093] {processor.py:163} INFO - Started process (PID=733) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:16:19,096] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:16:19,096] {logging_mixin.py:109} INFO - [2022-12-27 16:16:19,096] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:16:19,526] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:16:49,097] {logging_mixin.py:109} INFO - [2022-12-27 16:16:49,097] {timeout.py:36} ERROR - Process timed out, PID: 733
[2022-12-27 16:16:49,101] {logging_mixin.py:109} INFO - [2022-12-27 16:16:49,098] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 733
[2022-12-27 16:16:49,115] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:16:49,125] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.036 seconds
[2022-12-27 16:17:19,223] {processor.py:163} INFO - Started process (PID=789) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:17:19,226] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:17:19,227] {logging_mixin.py:109} INFO - [2022-12-27 16:17:19,227] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:17:19,790] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:17:49,228] {logging_mixin.py:109} INFO - [2022-12-27 16:17:49,228] {timeout.py:36} ERROR - Process timed out, PID: 789
[2022-12-27 16:17:49,231] {logging_mixin.py:109} INFO - [2022-12-27 16:17:49,228] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 789
[2022-12-27 16:17:49,260] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:17:49,285] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.065 seconds
[2022-12-27 16:18:19,437] {processor.py:163} INFO - Started process (PID=835) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:18:19,439] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:18:19,440] {logging_mixin.py:109} INFO - [2022-12-27 16:18:19,440] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:18:20,252] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:18:49,441] {logging_mixin.py:109} INFO - [2022-12-27 16:18:49,440] {timeout.py:36} ERROR - Process timed out, PID: 835
[2022-12-27 16:18:49,444] {logging_mixin.py:109} INFO - [2022-12-27 16:18:49,441] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 835
[2022-12-27 16:18:49,474] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:18:49,504] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.071 seconds
[2022-12-27 16:19:19,731] {processor.py:163} INFO - Started process (PID=889) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:19:19,735] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:19:19,736] {logging_mixin.py:109} INFO - [2022-12-27 16:19:19,736] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:19:20,299] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:19:49,738] {logging_mixin.py:109} INFO - [2022-12-27 16:19:49,738] {timeout.py:36} ERROR - Process timed out, PID: 889
[2022-12-27 16:19:49,742] {logging_mixin.py:109} INFO - [2022-12-27 16:19:49,739] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 889
[2022-12-27 16:19:49,762] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:19:49,779] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.051 seconds
[2022-12-27 16:20:19,932] {processor.py:163} INFO - Started process (PID=944) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:20:19,936] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:20:19,938] {logging_mixin.py:109} INFO - [2022-12-27 16:20:19,938] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:20:20,465] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:20:49,940] {logging_mixin.py:109} INFO - [2022-12-27 16:20:49,939] {timeout.py:36} ERROR - Process timed out, PID: 944
[2022-12-27 16:20:49,942] {logging_mixin.py:109} INFO - [2022-12-27 16:20:49,940] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 944
[2022-12-27 16:20:49,957] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:20:49,969] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.043 seconds
[2022-12-27 16:21:20,067] {processor.py:163} INFO - Started process (PID=1000) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:21:20,071] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:21:20,072] {logging_mixin.py:109} INFO - [2022-12-27 16:21:20,071] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:21:20,694] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:21:50,074] {logging_mixin.py:109} INFO - [2022-12-27 16:21:50,074] {timeout.py:36} ERROR - Process timed out, PID: 1000
[2022-12-27 16:21:50,077] {logging_mixin.py:109} INFO - [2022-12-27 16:21:50,075] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1000
[2022-12-27 16:21:50,096] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:21:50,110] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.047 seconds
[2022-12-27 16:22:20,214] {processor.py:163} INFO - Started process (PID=1045) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:22:20,217] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:22:20,218] {logging_mixin.py:109} INFO - [2022-12-27 16:22:20,218] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:22:20,673] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:22:50,221] {logging_mixin.py:109} INFO - [2022-12-27 16:22:50,219] {timeout.py:36} ERROR - Process timed out, PID: 1045
[2022-12-27 16:22:50,224] {logging_mixin.py:109} INFO - [2022-12-27 16:22:50,221] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1045
[2022-12-27 16:22:50,243] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:22:50,257] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.046 seconds
[2022-12-27 16:23:20,358] {processor.py:163} INFO - Started process (PID=1099) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:23:20,362] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:23:20,363] {logging_mixin.py:109} INFO - [2022-12-27 16:23:20,363] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:23:20,813] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:23:50,365] {logging_mixin.py:109} INFO - [2022-12-27 16:23:50,364] {timeout.py:36} ERROR - Process timed out, PID: 1099
[2022-12-27 16:23:50,369] {logging_mixin.py:109} INFO - [2022-12-27 16:23:50,366] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1099
[2022-12-27 16:23:50,392] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:23:50,407] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.053 seconds
[2022-12-27 16:24:20,538] {processor.py:163} INFO - Started process (PID=1154) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:24:20,542] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:24:20,543] {logging_mixin.py:109} INFO - [2022-12-27 16:24:20,543] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:24:21,015] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:24:50,544] {logging_mixin.py:109} INFO - [2022-12-27 16:24:50,544] {timeout.py:36} ERROR - Process timed out, PID: 1154
[2022-12-27 16:24:50,548] {logging_mixin.py:109} INFO - [2022-12-27 16:24:50,545] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1154
[2022-12-27 16:24:50,565] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:24:50,579] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.045 seconds
[2022-12-27 16:25:20,700] {processor.py:163} INFO - Started process (PID=1210) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:25:20,703] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:25:20,704] {logging_mixin.py:109} INFO - [2022-12-27 16:25:20,704] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:25:21,249] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:25:50,705] {logging_mixin.py:109} INFO - [2022-12-27 16:25:50,704] {timeout.py:36} ERROR - Process timed out, PID: 1210
[2022-12-27 16:25:50,709] {logging_mixin.py:109} INFO - [2022-12-27 16:25:50,705] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1210
[2022-12-27 16:25:50,730] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:25:50,743] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.046 seconds
[2022-12-27 16:26:20,848] {processor.py:163} INFO - Started process (PID=1256) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:26:20,851] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:26:20,853] {logging_mixin.py:109} INFO - [2022-12-27 16:26:20,853] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:26:21,396] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:26:50,855] {logging_mixin.py:109} INFO - [2022-12-27 16:26:50,854] {timeout.py:36} ERROR - Process timed out, PID: 1256
[2022-12-27 16:26:50,859] {logging_mixin.py:109} INFO - [2022-12-27 16:26:50,855] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1256
[2022-12-27 16:26:50,877] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:26:50,891] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.046 seconds
[2022-12-27 16:27:21,008] {processor.py:163} INFO - Started process (PID=1311) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:27:21,009] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:27:21,010] {logging_mixin.py:109} INFO - [2022-12-27 16:27:21,010] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:27:21,792] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:27:51,013] {logging_mixin.py:109} INFO - [2022-12-27 16:27:51,013] {timeout.py:36} ERROR - Process timed out, PID: 1311
[2022-12-27 16:27:51,017] {logging_mixin.py:109} INFO - [2022-12-27 16:27:51,014] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1311
[2022-12-27 16:27:51,034] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:27:51,048] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.043 seconds
[2022-12-27 16:28:21,147] {processor.py:163} INFO - Started process (PID=1356) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:28:21,148] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:28:21,149] {logging_mixin.py:109} INFO - [2022-12-27 16:28:21,149] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:28:21,684] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:28:51,150] {logging_mixin.py:109} INFO - [2022-12-27 16:28:51,150] {timeout.py:36} ERROR - Process timed out, PID: 1356
[2022-12-27 16:28:51,153] {logging_mixin.py:109} INFO - [2022-12-27 16:28:51,150] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1356
[2022-12-27 16:28:51,168] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:28:51,182] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.039 seconds
[2022-12-27 16:29:21,275] {processor.py:163} INFO - Started process (PID=1412) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:29:21,276] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:29:21,277] {logging_mixin.py:109} INFO - [2022-12-27 16:29:21,277] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:29:21,747] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:29:51,278] {logging_mixin.py:109} INFO - [2022-12-27 16:29:51,278] {timeout.py:36} ERROR - Process timed out, PID: 1412
[2022-12-27 16:29:51,283] {logging_mixin.py:109} INFO - [2022-12-27 16:29:51,279] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1412
[2022-12-27 16:29:51,316] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:29:51,329] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.058 seconds
[2022-12-27 16:30:21,459] {processor.py:163} INFO - Started process (PID=1465) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:30:21,460] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:30:21,460] {logging_mixin.py:109} INFO - [2022-12-27 16:30:21,460] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:30:21,946] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:30:51,462] {logging_mixin.py:109} INFO - [2022-12-27 16:30:51,462] {timeout.py:36} ERROR - Process timed out, PID: 1465
[2022-12-27 16:30:51,464] {logging_mixin.py:109} INFO - [2022-12-27 16:30:51,462] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1465
[2022-12-27 16:30:51,482] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:30:51,496] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.040 seconds
[2022-12-27 16:31:21,599] {processor.py:163} INFO - Started process (PID=1521) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:31:21,603] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:31:21,604] {logging_mixin.py:109} INFO - [2022-12-27 16:31:21,604] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:31:22,132] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:31:51,607] {logging_mixin.py:109} INFO - [2022-12-27 16:31:51,607] {timeout.py:36} ERROR - Process timed out, PID: 1521
[2022-12-27 16:31:51,611] {logging_mixin.py:109} INFO - [2022-12-27 16:31:51,608] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1521
[2022-12-27 16:31:51,627] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:31:51,639] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.044 seconds
[2022-12-27 16:32:21,733] {processor.py:163} INFO - Started process (PID=1567) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:32:21,736] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:32:21,737] {logging_mixin.py:109} INFO - [2022-12-27 16:32:21,736] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:32:22,150] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:32:51,738] {logging_mixin.py:109} INFO - [2022-12-27 16:32:51,737] {timeout.py:36} ERROR - Process timed out, PID: 1567
[2022-12-27 16:32:51,740] {logging_mixin.py:109} INFO - [2022-12-27 16:32:51,738] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1567
[2022-12-27 16:32:51,753] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:32:51,768] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.038 seconds
[2022-12-27 16:33:21,867] {processor.py:163} INFO - Started process (PID=1623) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:33:21,872] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:33:21,872] {logging_mixin.py:109} INFO - [2022-12-27 16:33:21,872] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:33:22,374] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:33:51,874] {logging_mixin.py:109} INFO - [2022-12-27 16:33:51,873] {timeout.py:36} ERROR - Process timed out, PID: 1623
[2022-12-27 16:33:51,877] {logging_mixin.py:109} INFO - [2022-12-27 16:33:51,874] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1623
[2022-12-27 16:33:51,896] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:33:51,910] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.048 seconds
[2022-12-27 16:34:22,035] {processor.py:163} INFO - Started process (PID=1677) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:34:22,038] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:34:22,039] {logging_mixin.py:109} INFO - [2022-12-27 16:34:22,039] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:34:22,471] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:34:52,041] {logging_mixin.py:109} INFO - [2022-12-27 16:34:52,041] {timeout.py:36} ERROR - Process timed out, PID: 1677
[2022-12-27 16:34:52,045] {logging_mixin.py:109} INFO - [2022-12-27 16:34:52,042] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1677
[2022-12-27 16:34:52,061] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:34:52,073] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.041 seconds
[2022-12-27 16:35:22,197] {processor.py:163} INFO - Started process (PID=1733) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:35:22,200] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:35:22,200] {logging_mixin.py:109} INFO - [2022-12-27 16:35:22,200] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:35:22,755] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:35:52,201] {logging_mixin.py:109} INFO - [2022-12-27 16:35:52,201] {timeout.py:36} ERROR - Process timed out, PID: 1733
[2022-12-27 16:35:52,205] {logging_mixin.py:109} INFO - [2022-12-27 16:35:52,202] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.7/http/client.py", line 1373, in getresponse
    response.begin()
  File "/usr/local/lib/python3.7/http/client.py", line 319, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.7/http/client.py", line 280, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/usr/local/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1733
[2022-12-27 16:35:52,227] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:35:52,254] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.061 seconds
[2022-12-27 16:36:22,386] {processor.py:163} INFO - Started process (PID=1781) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:36:22,389] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:36:22,390] {logging_mixin.py:109} INFO - [2022-12-27 16:36:22,390] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:36:22,998] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:36:52,391] {logging_mixin.py:109} INFO - [2022-12-27 16:36:52,391] {timeout.py:36} ERROR - Process timed out, PID: 1781
[2022-12-27 16:36:52,393] {logging_mixin.py:109} INFO - [2022-12-27 16:36:52,392] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 210, in run_etl
    get_events().to_sql(name='events', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 103, in get_events
    r = rq.get(f'{baseurl}{endpoint}/{a}{events_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1781
[2022-12-27 16:36:52,409] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:36:52,421] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.037 seconds
[2022-12-27 16:37:22,528] {processor.py:163} INFO - Started process (PID=1835) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:37:22,531] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:37:22,532] {logging_mixin.py:109} INFO - [2022-12-27 16:37:22,532] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:37:23,062] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
[2022-12-27 16:37:52,547] {logging_mixin.py:109} INFO - [2022-12-27 16:37:52,546] {timeout.py:36} ERROR - Process timed out, PID: 1835
[2022-12-27 16:37:52,554] {logging_mixin.py:109} INFO - [2022-12-27 16:37:52,548] {dagbag.py:334} ERROR - Failed to import: /opt/airflow/dags/etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/dagbag.py", line 331, in _load_modules_from_file
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 728, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/opt/airflow/dags/etl_dag.py", line 4, in <module>
    from etl import run_etl
  File "/opt/airflow/dags/etl.py", line 216, in <module>
    run_etl()
  File "/opt/airflow/dags/etl.py", line 208, in run_etl
    get_comics().to_sql(name='comics', con=conn, index=False, if_exists='replace')
  File "/opt/airflow/dags/etl.py", line 74, in get_comics
    r = rq.get(f'{baseurl}{endpoint}/{a}{comics_}?ts={ts}&apikey={api_key}&hash={hash_key}')
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connectionpool.py", line 394, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.7/http/client.py", line 1281, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1327, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1276, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.7/http/client.py", line 1036, in _send_output
    self.send(msg)
  File "/usr/local/lib/python3.7/http/client.py", line 976, in send
    self.connect()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/connection.py", line 175, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "/home/airflow/.local/lib/python3.7/site-packages/urllib3/util/connection.py", line 86, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/timeout.py", line 37, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/etl_dag.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.2.3/best-practices.html#reducing-dag-complexity, PID: 1835
[2022-12-27 16:37:52,594] {processor.py:656} WARNING - No viable dags retrieved from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:37:52,695] {processor.py:171} INFO - Processing /opt/airflow/dags/etl_dag.py took 30.157 seconds
[2022-12-27 16:38:22,856] {processor.py:163} INFO - Started process (PID=1881) to work on /opt/airflow/dags/etl_dag.py
[2022-12-27 16:38:22,862] {processor.py:642} INFO - Processing file /opt/airflow/dags/etl_dag.py for tasks to queue
[2022-12-27 16:38:22,862] {logging_mixin.py:109} INFO - [2022-12-27 16:38:22,862] {dagbag.py:500} INFO - Filling up the DagBag from /opt/airflow/dags/etl_dag.py
[2022-12-27 16:38:23,450] {logging_mixin.py:109} INFO - Connecting to Marvel Database...
